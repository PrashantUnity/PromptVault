@page "/"
@using PromptsValut.Constants

<PageTitle>PromptVault - AI Prompt Library</PageTitle>

<div class="lg:block hidden">
    <div id="main-view">
        <!-- Action buttons -->
        <div class="mb-8 transition-all duration-700 opacity-100 translate-y-0">
            <div class="flex items-center justify-start mb-4">
                <div class="flex flex-row items-center gap-3 w-full sm:w-auto">
                    <button @onclick="ShowFavorites" class="btn-secondary h-10 px-4 rounded-lg border border-red-200 bg-gradient-to-r from-red-50 to-pink-50 hover:from-red-100 hover:to-pink-100 hover:border-red-300 text-red-700 hover:text-red-800 dark:from-red-900/20 dark:to-pink-900/20 dark:hover:from-red-800/30 dark:hover:to-pink-800/30 dark:border-red-800 dark:hover:border-red-700 dark:text-red-300 dark:hover:text-red-200 flex items-center gap-2 flex-1 sm:flex-none justify-center sm:justify-start hover-lift">
                        @((MarkupString)SvgIcons.GetIcon("heart", "h-4 w-4"))
                        <span class="hidden sm:inline">Favorites (@PromptService.State.Favorites.Count)</span>
                    </button>
                    <button @onclick="ShowHistory" class="btn-secondary h-10 px-4 rounded-lg border border-purple-200 bg-gradient-to-r from-purple-50 to-indigo-50 hover:from-purple-100 hover:to-indigo-100 hover:border-purple-300 text-purple-700 hover:text-purple-800 dark:from-purple-900/20 dark:to-indigo-900/20 dark:hover:from-purple-800/30 dark:hover:to-indigo-800/30 dark:border-purple-800 dark:hover:border-purple-700 dark:text-purple-300 dark:hover:text-purple-200 flex items-center gap-2 flex-1 sm:flex-none justify-center sm:justify-start hover-lift">
                        @((MarkupString)SvgIcons.GetIcon("history", "h-4 w-4"))
                        <span class="hidden sm:inline">History</span>
                    </button>
                    <button @onclick="ShowCreateModal" class="btn-primary h-10 px-4 rounded-lg border border-green-200 bg-gradient-to-r from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100 hover:border-green-300 text-green-700 hover:text-green-800 dark:from-green-900/20 dark:to-emerald-900/20 dark:hover:from-green-800/30 dark:hover:to-emerald-800/30 dark:border-green-800 dark:hover:border-green-700 dark:text-green-300 dark:hover:text-green-200 flex items-center gap-2 flex-1 sm:flex-none justify-center sm:justify-start hover-lift">
                        @((MarkupString)SvgIcons.GetIcon("plus", "h-4 w-4"))
                        <span class="hidden sm:inline">Create</span>
                    </button>
                    <button @onclick="ShowExportImportModal" class="h-10 px-4 rounded-lg border border-orange-200 bg-gradient-to-r from-orange-50 to-yellow-50 hover:from-orange-100 hover:to-yellow-100 hover:border-orange-300 text-orange-700 hover:text-orange-800 dark:from-orange-900/20 dark:to-yellow-900/20 dark:hover:from-orange-800/30 dark:hover:to-yellow-800/30 dark:border-orange-800 dark:hover:border-orange-700 dark:text-orange-300 dark:hover:text-orange-200 flex items-center gap-2 flex-1 sm:flex-none justify-center sm:justify-start">
                        @((MarkupString)SvgIcons.GetIcon("download", "h-4 w-4"))
                        <span class="hidden sm:inline">Export/Import</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Prompt grid -->
        @if (PromptService.State.IsLoading)
        {
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4 2xl:grid-cols-4 gap-4 lg:gap-6">
                @for (int i = 0; i < 8; i++)
                {
                    <div class="skeleton-card stagger-item">
                        <div class="skeleton-line long"></div>
                        <div class="skeleton-line medium"></div>
                        <div class="skeleton-line short"></div>
                        <div class="flex items-center justify-between mt-4">
                            <div class="skeleton-circle"></div>
                            <div class="skeleton-line short w-16"></div>
                        </div>
                    </div>
                }
            </div>
        }
        else if (PromptService.FilteredPrompts.Any())
        {
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4 2xl:grid-cols-4 gap-4 lg:gap-6">
                @foreach (var prompt in PromptService.FilteredPrompts)
                {
                    <PromptCard Prompt="prompt" OnPromptClick="@OnPromptClick" OnToggleFavorite="@OnToggleFavorite" OnSetRating="@OnSetRating" />
                }
            </div>
        }
        else
        {
            <div class="text-center py-12">
                <div class="w-24 h-24 mx-auto mb-4 bg-muted rounded-full flex items-center justify-center">
                    @((MarkupString)SvgIcons.GetIcon("search", "w-12 h-12 text-muted-foreground"))
                </div>
                <p class="text-lg text-muted-foreground">
                    No prompts found matching your criteria.
                </p>
            </div>
        }
    </div>
</div>

<!-- Mobile Layout -->
<div class="lg:hidden">
    <div id="mobile-main-view">
        <!-- Action buttons -->
        <div class="mb-6 transition-all duration-700 opacity-100 translate-y-0">
            <div class="grid grid-cols-2 gap-3">
                <button @onclick="ShowFavorites" class="btn-secondary h-11 px-3 rounded-lg border border-red-200 bg-gradient-to-r from-red-50 to-pink-50 hover:from-red-100 hover:to-pink-100 hover:border-red-300 text-red-700 hover:text-red-800 dark:from-red-900/20 dark:to-pink-900/20 dark:hover:from-red-800/30 dark:hover:to-pink-800/30 dark:border-red-800 dark:hover:border-red-700 dark:text-red-300 dark:hover:text-red-200 flex items-center justify-center gap-1.5 transition-all duration-200 hover-lift">
                    @((MarkupString)SvgIcons.GetIcon("heart", "h-4 w-4"))
                    <span class="text-xs font-medium">Favorites</span>
                    <span class="text-xs bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200 px-1.5 py-0.5 rounded-full">@PromptService.State.Favorites.Count</span>
                </button>
                <button @onclick="ShowHistory" class="h-11 px-3 rounded-lg border border-purple-200 bg-gradient-to-r from-purple-50 to-indigo-50 hover:from-purple-100 hover:to-indigo-100 hover:border-purple-300 text-purple-700 hover:text-purple-800 dark:from-purple-900/20 dark:to-indigo-900/20 dark:hover:from-purple-800/30 dark:hover:to-indigo-800/30 dark:border-purple-800 dark:hover:border-purple-700 dark:text-purple-300 dark:hover:text-purple-200 flex items-center justify-center gap-1.5 transition-all duration-200">
                    @((MarkupString)SvgIcons.GetIcon("history", "h-4 w-4"))
                    <span class="text-xs font-medium">History</span>
                </button>
                <button @onclick="ShowCreateModal" class="h-11 px-3 rounded-lg border border-green-200 bg-gradient-to-r from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100 hover:border-green-300 text-green-700 hover:text-green-800 dark:from-green-900/20 dark:to-emerald-900/20 dark:hover:from-green-800/30 dark:hover:to-emerald-800/30 dark:border-green-800 dark:hover:border-green-700 dark:text-green-300 dark:hover:text-green-200 flex items-center justify-center gap-1.5 transition-all duration-200">
                    @((MarkupString)SvgIcons.GetIcon("plus", "h-4 w-4"))
                    <span class="text-xs font-medium">Create</span>
                </button>
                <button @onclick="ShowExportImportModal" class="h-11 px-3 rounded-lg border border-orange-200 bg-gradient-to-r from-orange-50 to-yellow-50 hover:from-orange-100 hover:to-yellow-100 hover:border-orange-300 text-orange-700 hover:text-orange-800 dark:from-orange-900/20 dark:to-yellow-900/20 dark:hover:from-orange-800/30 dark:hover:to-yellow-800/30 dark:border-orange-800 dark:hover:border-orange-700 dark:text-orange-300 dark:hover:text-orange-200 flex items-center justify-center gap-1.5 transition-all duration-200">
                    @((MarkupString)SvgIcons.GetIcon("download", "h-4 w-4"))
                    <span class="text-xs font-medium">Export</span>
                </button>
            </div>
        </div>

        <!-- Prompt grid -->
        @if (PromptService.State.IsLoading)
        {
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4">
                @for (int i = 0; i < 6; i++)
                {
                    <div class="skeleton-card stagger-item">
                        <div class="skeleton-line long"></div>
                        <div class="skeleton-line medium"></div>
                        <div class="skeleton-line short"></div>
                        <div class="flex items-center justify-between mt-4">
                            <div class="skeleton-circle"></div>
                            <div class="skeleton-line short w-16"></div>
                        </div>
                    </div>
                }
            </div>
        }
        else if (PromptService.FilteredPrompts.Any())
        {
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4">
                @foreach (var prompt in PromptService.FilteredPrompts)
                {
                    <PromptCard Prompt="prompt" OnPromptClick="@OnPromptClick" OnToggleFavorite="@OnToggleFavorite" OnSetRating="@OnSetRating" />
                }
            </div>
        }
        else
        {
            <div class="text-center py-8">
                <div class="w-16 h-16 mx-auto mb-4 bg-muted rounded-full flex items-center justify-center">
                    @((MarkupString)SvgIcons.GetIcon("search", "w-8 h-8 text-muted-foreground"))
                </div>
                <p class="text-base text-muted-foreground">
                    No prompts found matching your criteria.
                </p>
            </div>
        }
    </div>
</div>

<!-- Modals -->
<PromptDetailModal @ref="promptDetailModal" IsVisible="showPromptDetail" OnClose="ClosePromptDetail" />
<HelpModal @ref="helpModal" IsVisible="PromptService.ShowHelpModal" OnClose="CloseHelpModal" />
<FavoritesModal @ref="favoritesModal" IsVisible="PromptService.ShowFavoritesModal" OnClose="CloseFavoritesModal" OnViewPrompt="OnPromptClick" />
<CreateModal @ref="createModal" IsVisible="showCreateModal" OnClose="CloseCreateModal" />
<ExportImportModal @ref="exportImportModal" IsVisible="showExportImportModal" OnClose="CloseExportImportModal" />
